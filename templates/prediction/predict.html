<!DOCTYPE html>
{% load static %}
<html>
  <head>
    <title>Machine Learning - Sentiment Analysis</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel='stylesheet' type='text/css' href={% static "css/main.css" %} class='css'>
  </head>

  <body>

    <nav class="navbar navbar-expand-lg navbar-light nav-color">
        <div class="container-fluid">
          <a class="navbar-brand ms-5 text-white" href="#">Sarwar's</a>
          <div
            class="collapse navbar-collapse justify-content-center"
            id="navbarNavAltMarkup"
          >
            <div class="navbar-nav">
              <a class="nav-link active text-white" aria-current="page" href="#">Home</a>
              <a class="nav-link text-white" href="#">Features</a>
              <a class="nav-link text-white" href="#">Pricing</a>
            </div>
          </div>
        </div>
      </nav>

    <div class="container">
      <div class="row">
        <h3 class="mt-5">Sentiment Analysis</h3>
        <div class="col-6 p-3">
          <div class="border border-secondary rounded-1">
            <form method="post" id='predSentiment'>
              {% csrf_token %}
              <div class="form-group w-75 mt-2 ms-2">
                <label for="exampleFormControlTextarea1">Type Your Text</label>
                <textarea
                  class="form-control mt-1 border border-primary"
                  id="comment"
                  name="comment"
                  rows="5"
                ></textarea>
              </div>
              <div class="d-flex ms-2 my-2">
                <button type="submit" class="btn btn-primary btn-block">
                  Predict
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="col-6 p-3">
          <div class="border border-secondary rounded-1 h-100">
              <p class="form-group w-75 mt-2 ms-2 fw-bold">Predicted Result</p>
              <div class="d-flex justify-content-between px-3">
                <p class="lh-1 fw-semibold">Class</p>
                <p class="lh-1 fw-semibold">Cofidence</p>
              </div>
              <hr class="" />
              <div class="d-flex justify-content-between px-3">
                <p class='text-primary'><span id='result-sentiment'></p>
                <p class='text-primary'><span id='result-text'></p>
              </div>
              <hr />
          </div>
        </div>
      </div>
    </div>

    <h3 class="mt-5 d-flex justify-content-center">Sentiment Analysis benefits</h3>

    <div class="blockcode">
        <footer class="shadow footer fixed-bottom">
          <div
            class="d-flex justify-content-between align-items-center mx-auto py-4 flex-wrap"
            style="width: 80%"
          >
            <a href="/#" class="d-flex align-items-center p-0 text-dark">
              <img alt="logo" src="../img/logo.png" width="30px" />
              <span class="ms-4 h5 font-weight-bold">Devwares</span>
            </a>
            <small>&copy; Sarwar's, 2024. All rights reserved.</small>
            <div>
              <button class="btn btn-dark btn-flat p-2">
                <i class="fa fa-facebook"></i>
              </button>
              <button class="btn btn-dark btn-flat p-2">
                <i class="fa fa-twitter"></i>
              </button>
              <button class="btn btn-dark btn-flat p-2">
                <i class="fa fa-instagram"></i>
              </button>
            </div>
          </div>
        </footer>
      </div>
    

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script>
        document.addEventListener('DOMContentLoaded', function(){
            var form = document.getElementById('predSentiment');
            var textData = ''
            form.addEventListener('submit', function (e){
                e.preventDefault();
                var formData = new FormData(form);
        
                fetch('{% url 'Predict_Data' %}',{
                    method: 'POST',
                    body: formData,
                })
                .then(response => response.json())
                .then(data => {
                    document.getElementById('result-sentiment').textContent=`${data.sentiment[0][1]===0 ? "Negative" : "Positive"}`;
                    document.getElementById('result-text').textContent=data.sentiment[0][2];
                })
                .catch(error => console.error('Error', error))
            })
        })
    </script>

  </body>
</html>
